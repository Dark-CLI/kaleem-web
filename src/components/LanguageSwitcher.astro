---
import { getRelativeLocaleUrl } from 'astro:i18n';

const currentLocale = Astro.currentLocale;
const otherLocale = currentLocale === 'en' ? 'ar' : 'en';
const defaultLocale = 'en'; // As configured in astro.config.mjs

let canonicalPath = Astro.url.pathname;
const localePrefix = `/${currentLocale}`;

// If the current path starts with the locale prefix, remove it to get the base path
if (currentLocale !== defaultLocale && canonicalPath.startsWith(localePrefix)) {
  canonicalPath = canonicalPath.substring(localePrefix.length) || '/';
}

const otherLocaleUrl = getRelativeLocaleUrl(otherLocale, canonicalPath);
---

<a href={otherLocaleUrl} class="language-switcher header-link">
  {otherLocale.toUpperCase()}
</a>
