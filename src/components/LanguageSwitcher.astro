---
import { getRelativeLocaleUrl } from 'astro:i18n';

const currentLocale = Astro.currentLocale;
const otherLocale = currentLocale === 'en' ? 'ar' : 'en';
const defaultLocale = 'en'; // As configured in astro.config.mjs

let canonicalPath = Astro.url.pathname;
const localePrefix = `/${currentLocale}`;

// If the current path starts with the locale prefix, remove it to get the base path
if (currentLocale !== defaultLocale && canonicalPath.startsWith(localePrefix)) {
  canonicalPath = canonicalPath.substring(localePrefix.length) || '/';
}

const otherLocaleUrl = getRelativeLocaleUrl(otherLocale, canonicalPath);
---

<a href={otherLocaleUrl} class="language-switcher">
  {otherLocale.toUpperCase()}
</a>

<style>
  .language-switcher {
    font-size: inherit;
    font-family: inherit;
    color: var(--accent);
    text-decoration: none;
    padding: 1.75em 1em;
    border-bottom: 2px solid transparent;
    transition: border-color 0.2s ease-in-out, color 0.2s ease-in-out;
  }
  .language-switcher:hover {
    color: var(--accent-dark);
    border-bottom-color: var(--accent-dark);
  }
</style>
