---
import { getRelativeLocaleUrl } from 'astro:i18n';

const currentLocale = Astro.currentLocale;
const otherLocale = currentLocale === 'en' ? 'ar' : 'en';
const defaultLocale = 'en'; // As configured in astro.config.mjs

let canonicalPath = Astro.url.pathname;
const localePrefix = `/${currentLocale}`;

// If the current path starts with the locale prefix, remove it to get the base path
if (currentLocale !== defaultLocale && canonicalPath.startsWith(localePrefix)) {
  canonicalPath = canonicalPath.substring(localePrefix.length) || '/';
}

const otherLocaleUrl = getRelativeLocaleUrl(otherLocale, canonicalPath);
---

<a href={otherLocaleUrl} class="language-switcher">
  {otherLocale.toUpperCase()}
</a>

<style>
  .language-switcher {
    display: flex;
    align-items: center;
    justify-content: center;
    box-sizing: border-box;
    -webkit-appearance: none;
    -moz-appearance: none;
    appearance: none;
    text-decoration: none;
    padding: 0.5em 1em;
    border: none !important;
    outline: none !important;
    box-shadow: none !important;
    border-radius: 8px;
    color: var(--header-text);
    font-weight: 700;
    transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
    font-size: 0.9em;
  }

  .language-switcher:hover {
    background-color: rgba(128, 128, 128, 0.1);
    color: var(--header-text);
  }

  .icon {
    width: 1.1rem;
    height: 1.1rem;
  }
</style>
